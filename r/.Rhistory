View(agg)
complexes.new <- merge(complexes, agg, by.x = "ID", by.y = "COMPLEX_ID")
View(complexes.new)
complexes.new$SCHOOLS_COUNT <- complexes.new$x
complexes.new$x <- NULL
complexes <- complexes.new
rm(complexes.new)
rm(agg)
save.image()
savehistory()
write.csv(complexes, file = "../csv/complexes.csv", row.names = FALSE, na="")
schools.new <- school.blocks
school.blocks.new <- schools
schools <- schools.new
school.blocks <- school.blocks.new
rm(schools.new)
rm(school.blocks.new)
View(schools)
View(school.blocks)
write.csv(schools, file = "../csv/schools.csv", row.names = FALSE, na="")
school2building <- read.csv("../csv/school2building.csv")
write.csv(school.blocks, file = "../csv/school.blocks.csv", row.names = FALSE, na="")
complexes <- complexes[c(2,1,3,4,5,6,7,8,9,10,11,12,13)]
View(complexes)
write.csv(complexes, file = "../csv/complexes.csv", row.names = FALSE, na="")
school.blocks <- school.blocks[c(2,3,1,4,5,6,7,8,9,10,11,12,13,14)]
View(school.blocks)
write.csv(school.blocks, file = "../csv/school.blocks.csv", row.names = FALSE, na="")
save.image()
savehistory()
school.blocks$ASSIGNMENT_AREA_STUDENTS <- NULL
View(school.blocks)
school.blocks$RATING <- NULL
school.blocks$COMPLEX_ID<- NULL
View(school.blocks)
school.blocks$CLOSED<- NULL
View(school.blocks)
school.blocks$TYPE<- NULL
View(school.blocks)
subset(schools, NAME = "Государственное бюджетное образовательное учреждение города Москвы средняя общеобразовательная школа №459")
subset(schools, NAME = "Государственное бюджетное образовательное учреждение города Москвы средняя общеобразовательная школа №459",)
subset(schools, NAME == "Государственное бюджетное образовательное учреждение города Москвы средняя общеобразовательная школа №459")
subset(schools, NAME == "Государственное бюджетное образовательное учреждение города Москвы средняя общеобразовательная школа №459")$ID
subset(schools, NAME == "Государственное бюджетное образовательное учреждение города Москвы средняя общеобразовательная школа №459")$ID[1]
school.blocks$SCHOOL_ID <- sapply(school_blocks$NAME, {function(x) subset(schools, NAME == x)$ID[1]})
school.blocks$SCHOOL_ID <- sapply(school.blocks$NAME, {function(x) subset(schools, NAME == x)$ID[1]})
View(school.blocks)
school.blocks$OBJECTID <- NULL
school.blocks$OBJECTID_OLD <- NULL
View(school.blocks)
school.blocks$NEW_ID <- list(1:nrow(school.blocks))
View(school.blocks)
school.blocks$NEW_ID <- 1:nrow(school.blocks)
View(school.blocks)
school.blocks$ID <- school.blocks$NEW_ID
school.blocks$NEW_ID <- NULL
View(school.blocks)
school.blocks<- school.blocks[c(1, 8, 2,3,4,5,6,7)]
View(school.blocks)
write.csv(school.blocks, file = "../csv/school.blocks.csv", row.names = FALSE, na="")
save.image()
savehistory()
class(schools$TYPE)
subset(schools, TYPE == NULL)
subset(schools, is.na(TYPE))
subset(schools, TYPE=="")
table(schools$TYPE)
agg <- aggregate(school2building$SCHOOL_ID, list(BUILDING_ID = school2building$BUILDING_ID), length)
View(agg)
agg[agg$BUILDING_ID %in% buildings$ID]
subset(agg, agg$BUILDING_ID %in% buildings$ID)
agg <- subset(agg, agg$BUILDING_ID %in% buildings$ID)
View(agg)
rm(agg)
buildings.new <- buildings
buildings.new <- buildings.new[c(2)]
agg <- aggregate(school2building$SCHOOL_ID, list(BUILDING_ID = school2building$BUILDING_ID), length)
View(agg)
buildings.new <- merge(buildings.new, agg, by.x = "ID", by.y = "BUILDING_ID")
View(buildings.new)
buildings.new$AVAILABLE_SCHOOLS <- buildings.new$x
buildings.new$x <- NULL
rm(agg)
buildings.new.new <- merge(buildings, buildings.new, by.x = "ID", by.y = "ID", all.x = TRUE)
View(buildings.new.new)
buildings.new.new <- buildings.new.new[c(2,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17)]
class(buildings.new.new$AVAILABLE_SCHOOLS)
buildings.new.new[order(buildings.new.new$AVAILABLE_SCHOOLS, na.last = FALSE)]
buildings.new.new[order(AVAILABLE_SCHOOLS, na.last = FALSE)]
buildings.new.new[order(AVAILABLE_SCHOOLS, na.last = FALSE),]
buildings.new.new[order(buildings.new.new$AVAILABLE_SCHOOLS, na.last = FALSE),]
buildings.new.new$AVAILABLE_SCHOOLS1 <- sapply(buildings.new.new$AVAILABLE_SCHOOLS, {function(x) ifelse(is.na(x), 0, x)})
View(buildings.new.new)
buildings.new.new[order(buildings.new.new$AVAILABLE_SCHOOLS1, na.last = FALSE),]
buildings.new.new$AVAILABLE_SCHOOLS <- buildings.new.new$AVAILABLE_SCHOOLS1
buildings.new.new$AVAILABLE_SCHOOLS1 <- NULL
buildings.new.new[order(buildings.new.new$AVAILABLE_SCHOOLS1, na.last = FALSE),]
buildings.new.new[order(buildings.new.new$AVAILABLE_SCHOOLS, na.last = FALSE),]
save.image()
savehistory()
agg <- aggregate(school2building$SCHOOL_ID, list(BUILDING_ID = school2building$BUILDING_ID), length)
buildings.new <- buildings[c[2]]
buildings.new <- buildings[c(2)]
buildings.new.new <- merge(buildings.new, agg, by.x = "ID", by.y = "BUILDING_ID", all.x = TRUE)
View(buildings.new.new)
buildings.new.new$y <- sapply(buildings.new.new$x, {function(x) ifelse(is.na(x), 0, x)})
buildings.new.new$x <- NULL
buildings.new.new <- merge(buildings, buildings.new.new, by.x = "ID", by.y = "ID", all.x = TRUE)
buildings.new.new <- merge(buildings.new, agg, by.x = "ID", by.y = "BUILDING_ID", all.x = TRUE)
buildings.new.new$y <- sapply(buildings.new.new$x, {function(x) ifelse(is.na(x), 0, x)})
buildings.new.new$x <- NULL
buildings.new.new.new <- merge(buildings, buildings.new.new, by.x = "ID", by.y = "ID")
View(buildings.new)
buildings.new.new <- merge(buildings.new, agg, by.x = "ID", by.y = "BUILDING_ID", all.x = TRUE, sort = FALSE)
View(buildings.new.new)
buildings.new.new$y <- buildings.new.new$x
View(buildings.new.new)
buildings.new.new$z <- sapply(buildings.new.new$y, {function(x) ifelse(is.na(x), 0, x)})
View(buildings.new.new)
buildings.new.new$x <- NULL
buildings.new.new$y <- NULL
View(buildings.new.new)
buildings.new.new.new <- merge(buildings, buildings.new.new, by.x = "ID", by.y = "ID")
subset(buildings, !(ID %in% buildings.new.new$ID))
subset(buildings.new.new, !(ID %in% buildings$ID))
class(buildings$ID)
class(buildings.new.new$ID)
buildings.new.new.new <- merge(buildings, buildings.new.new, by = "ID")
View(buildings.new.new.new)
aggg < aggregate(buildings.new.new.new$ID, list(ID = buildings.new.new.new$ID), length)
aggg <- aggregate(buildings.new.new.new$ID, list(ID = buildings.new.new.new$ID), length)
View(aggg)
aggg <- aggregate(buildings$ID, list(ID = buildings$ID), length)
subset(buildings, ID == 9578)
aggg <- aggg[order(aggg$x, decreasing = TRUE)]
aggg <- aggg[order(aggg$x, decreasing = TRUE),]
View(aggg)
aggg[aggg$x > 1]
aggg[aggg$x > 1,]
sum(aggg[aggg$x > 1,]$x)
subset(buildings, ID == 15603)
building15603<- subset(buildings, ID == 15603)
View(building15603)
buildings.double <- aggg[aggg$x > 1,]
View(buildings.double)
rm(agg)
rm(aggg)
rm(building15603)
rm(buildings.new)
rm(buildings.new.new)
rm(buildings.new.new.new)
write.csv(buildings.double, file = "../csv/buildings.double.csv")
subset(school2building, BUILDING_ID == 15603)
length(subset(school2building, BUILDING_ID == 15603))
nrow(subset(school2building, BUILDING_ID == 15603))
nrow(subset(school2building, BUILDING_ID == 38652))
subset(school2building, BUILDING_ID == 38652)
school2building.new <- read.csv("../csv/school2building_from_arcmap.csv")
View(school2building.new)
school2building <- school2building.new
rm(school2building.new)
subset(school2building, BUILDING_ID == 15603)
buildings$NEW_ID <- buildings$OBJECTID
View(buildings)
buildings <- buildings[c(1,2,17,3,4,5,6,7,8,9,10,11,12,13,14,15,16)]
View(buildings)
school2building$NEW_BUILDING_ID
subset(buildings, ID = 30100)
subset(buildings, ID == 30100)
subset(buildings, ID == 15603)
subset(buildings, ID == 15603)$NEW_ID
subset(buildings, ID == 15603)$NEW_ID[1]
school2building$NEW_BUILDING_ID <- subset(buildings, ID == school2building$BUILDING_ID)$NEW_ID[1]
school2building$NEW_BUILDING_ID <- sapply(school2building$BUILDING_ID, {function(x) subset(buildings, ID == x)$NEW_ID[1]})
View(school2building)
school2building$NEW_BUILDING_ID <- school2building$BUILDING_ID
View(buildings)
View(school2building)
school2building.new <- building2school.generate.new.building.id(buildings, school2building)
building2school.generate.new.building.id = function(buildings, school2building){
for (bIdx in 1:nrow(buildings)) {
bId <- buildings$ID[bIdx];
bNewId <- buildings$NEW_ID[bIdx];
school2building$NEW_BUILDING_ID[school2building$NEW_BUILDING_ID == bId] <- bNewId;
print(paste(bIdx, " ", buildings$NAME[bIdx], " ", round((100*bIdx)/nrow(buildings), digits = 2), "%", sep = ""));
};
building2school.generate.new.building.id <- school2building;
}
school2building.new <- building2school.generate.new.building.id(buildings, school2building)
View(school2building.new)
buildings.double[x >2]
buildings.double[buildings.double$x >2]
buildings.double[buildings.double$x >2,]
buildings.double[buildings.double$x >2,]$ID
buildings[ID == 15603,]
buildings[buildings$ID == 15603,]
length(buildings[buildings$ID == 15603,])
nrow(buildings[buildings$ID == 15603,])
building2school.new[building2school.new$ID == 15603,]
school2building.new[school2building.new$ID == 15603,]
school2building.new[school2building.new$BUILDING_ID == 15603,]
nrow(school2building.new[school2building.new$BUILDING_ID == 15603,])
nrow(school2building.new[school2building.new$BUILDING_ID == 15603,])/2
school2building15603 <- school2building.new[school2building.new$BUILDING_ID == 15603,]
aggregate(school2building15603$OBJECTID, list(SCHOOL_ID = school2building15603$SCHOOL_ID, length)
)
aggregate(school2building15603$OBJECTID, list(SCHOOL_ID = school2building15603$SCHOOL_ID), length)
school2building.new[school2building.new$SCHOOL_ID == 10553,]
school2building.new[school2building.new$BUILDING_ID == 15603 AND school2building.new$SCHOOL_ID == 10553,]
school2building.new[school2building.new$BUILDING_ID == 15603 & school2building.new$SCHOOL_ID == 10553,]
nrow(school2building.new[school2building.new$BUILDING_ID == 15603 & school2building.new$SCHOOL_ID == 10553,])
school2building15603.new <- school2building.new[school2building.new$BUILDING_ID == 15603 & school2building.new$SCHOOL_ID == 10553,]
View(school2building15603.new)
school2building15603.new <- subset(school2building.new, OBJECTID < 127362)
school2building15603.new <- school2building.new[school2building.new$BUILDING_ID == 15603 & school2building.new$SCHOOL_ID == 10553,]
school2building15603.new <- subset(school2building15603.new, OBJECTID < 127362)
school2building15603.new$x <- buildings[buildings$ID==15603,]$NEW_ID
buildings[buildings$ID==15603,]
school2building15603.new$NEW_BUILDING_ID <- school2building15603.new$x
school2building15603.new$x <- NULL
school2building.to.change <- school2building15603.new
school2building15603.new <- school2building.new[school2building.new$BUILDING_ID == 15603 & school2building.new$SCHOOL_ID == "10554",]
school2building15603.new <- school2building.new[school2building.new$BUILDING_ID == 15603 & school2building.new$SCHOOL_ID == 10554,]
View(school2building15603.new)
school2building15603.new <- subset(school2building15603.new, OBJECTID < 127419)
school2building15603.new$x <- buildings[buildings$ID==15603,]$NEW_ID
school2building15603.new$NEW_BUILDING_ID <- school2building15603.new$x
school2building15603.new$x <- NULL
school2building.to.change <- rbind(school2building.to.change, school2building15603.new)
View(school2building.to.change)
rm(school2building15603)
rm(school2building15603.new)
school2building.new.new <- subset(school2building.new, OBJECTID != 127419 & OBJECTID != 127362)
school2building.new <- school2building.new.new
rm(school2building.new.new)
school2building.new.new <- subset(school2building.new,  BUILDING_ID != 15603)
nrow(school2building.new) - nrow(school2building.new.new)
school2building.new.new <- rbind(school2building.new.new, school2building.to.change)
subset(school2building.new.new,  BUILDING_ID == 15603)
school2building.new <- school2building.new.new
subset(school2building.new,  BUILDING_ID == 15603)
rm(school2building.new.new)
save.image()
buildings[buildings$ID == 38652,]
school2building[school2building$BUILDING_ID == 38652,]
school2building.to.change <- school2building[school2building$BUILDING_ID == 38652,]
school2building.to.replace <- school2building[school2building$BUILDING_ID == 38652,]
school2building.to.replace$NEW_BUILDING_ID <- 21235
View(school2building.to.replace)
school2building.to.change <- school2building.to.replace
school2building.to.replace$NEW_BUILDING_ID <- 21236
school2building.to.change <- rbind(school2building.to.change, school2building.to.replace)
school2building.to.replace$NEW_BUILDING_ID <- 21237
school2building.to.change <- rbind(school2building.to.change, school2building.to.replace)
school2building.to.replace$NEW_BUILDING_ID <- 21238
school2building.to.change <- rbind(school2building.to.change, school2building.to.replace)
school2building.new.new <- subset(school2building.new, BUILDING_ID == 38652)
school2building.new.new <- subset(school2building.new, BUILDING_ID != 38652)
school2building.new.new <- rbind(school2building.new.new, school2building.to.change)
subset(school2building.new.new, BUILDING_ID == 38652)
school2building.new <- school2building.new.new
rm(school2building.new.new, school2building.to.replace)
buildings[buildings$ID == 9917,]
school2building[school2building$BUILDING_ID == 9917,]
school2building.new.new <- school2building[school2building$BUILDING_ID != 9917,]
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 9917,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID != 9917 & (school2building.new$BUILDING_ID == 10483 | school2building.new$BUILDING_ID == 10484),]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID != 9917 & (school2building.new$BUILDING_ID == 10483),]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID != 9917 & (school2building.new$SCHOOL_ID == 10483 | school2building.new$SCHOOL_ID == 10484),]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID != 9917,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 9917,]
school2building.new.to.add <-  school2building.new.to.add[school2building.new.to.add$SCHOOL_ID == 10483 | school2building.new.to.add$SCHOOL_ID == 10484,]
View(school2building.new.to.add)
school2building.new.to.add$NEW_BUILDING_ID <- 12017
View(school2building.new.to.add)
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.add)
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID != 9917 & school2building.new$SCHOOL_ID %in% (10810, 10850, 10851, 11206, 11207, 11464, 11465, 11467, 11468),]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID = 9917 & school2building.new$SCHOOL_ID %in% (10810, 10850, 10851, 11206, 11207, 11464, 11465, 11467, 11468),]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 9917 & school2building.new$SCHOOL_ID %in% (10810, 10850, 10851, 11206, 11207, 11464, 11465, 11467, 11468),]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 9917 & school2building.new$SCHOOL_ID %in% list(10810, 10850, 10851, 11206, 11207, 11464, 11465, 11467, 11468),]
View(school2building.new.to.add)
school2building.new.to.add$NEW_BUILDING_ID <- 2632
school2building.new.to.change <- school2building.new.to.add
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 9917 & school2building.new$SCHOOL_ID %in% list(10810, 10850, 10851, 11206, 11207, 11464, 11465, 11467, 11468),]
View(school2building.new.to.add)
school2building.new.to.add$NEW_BUILDING_ID <- 2633
school2building.new.to.change <- rbind(school2building.new.to.change, school2building.new.to.add)
View(school2building.new.to.change)
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new <- school2building.new.new
rm(school2building.new.new )
rm(school2building.to.change )
rm(school2building.new.to.add )
rm(school2building.new.to.change )
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 9988,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 9988,]
View(school2building.new.to.add)
buildings[buildings$ID == 9988,]
View(school2building.new.to.add)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10810, 10849, 10850, 10851, 11206, 11207, 11272, 11464, 11465, 11466, 11467, 11468),]
school2building.new.to.change$NEW_BUILDING_ID <- 8434
View(school2building.new.to.change)
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(11154, 11155, 11254, 11255, 11426),]
View(school2building.new.to.change)
buildings[buildings$ID == 9988,]
buildings[buildings$ID == 4443,]
buildings[buildings$NEW_ID == 4443,]
buildings[buildings$ID == 9988,]
school2building.new.to.change$NEW_BUILDING_ID <- 2836
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change$NEW_BUILDING_ID <- 7738
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new <- school2building.new.new
buildings[buildings$ID == 10691,]
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 10691,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 10691,]
View(school2building.new.to.add)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(11312, 11371, 11372),]
school2building.new.to.change$NEW_BUILDING_ID <- 8096
View(school2building.new.to.add)
View(school2building.new.to.change)
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10671, 10842, 11315),]
school2building.new.to.change$NEW_BUILDING_ID <- 3504
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change$NEW_BUILDING_ID <- 3505
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new <- school2building.new.new
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 10692,]
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 10692,]
buildings[buildings$ID == 10692,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 10692,]
View(school2building.new.to.add)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(11312, 11371, 11372),]
school2building.new.to.change$NEW_BUILDING_ID <- 8098
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10671, 10842, 11315),]
school2building.new.to.change$NEW_BUILDING_ID <- 18375
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change$NEW_BUILDING_ID <- 18377
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new <- school2building.new.new
buildings[buildings$ID == 10701,]
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 10701,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 10701,]
View(school2building.new.to.add)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10671, 10842, 11315),]
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(11312, 11371, 11372),]
school2building.new.to.change$NEW_BUILDING_ID <- 13035
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10671, 10842, 11315),]
school2building.new.to.change$NEW_BUILDING_ID <- 13382
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change$NEW_BUILDING_ID <- 13444
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new <- school2building.new.new
buildings[buildings$ID == 12485,]
school2building.new.new <- school2building.new[school2building.new$BUILDING_ID != 12485,]
school2building.new.to.add <- school2building.new[school2building.new$BUILDING_ID == 12485,]
View(school2building.new.to.add)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10310, 10762, 11292),]
school2building.new.to.change$NEW_BUILDING_ID <- 28898
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10157, 11321, 11322, 11323, 11483),]
school2building.new.to.change$NEW_BUILDING_ID <- 4596
school2building.new.to.change <- school2building.new.to.add[school2building.new.to.add$SCHOOL_ID %in% list(10157, 11321, 11322, 11323, 11483),]
school2building.new.to.change$NEW_BUILDING_ID <- 4597
school2building.new.new <- rbind(school2building.new.new, school2building.new.to.change)
school2building.new <- school2building.new.new
buildings[buildings$ID == 1030,]
aggg <- aggregate(buildings$ID, list(ID = buildings$ID), length)
aggg <- aggregate(buildings$ID, list(ID = buildings$NEW_ID), length)
rm(aggg)
buildings.double1 <- buildings.double[buildings.double$x== 2,]
buildings.double1 -> buildings.double
rm(buildings.double1)
View(buildings.double)
rm(school2building.new.to.add)
rm(school2building.new.to.change)
rm(school2building.new.new)
buildings.from.arcmap <- read.csv("../csv/buildings_from_arcmap.csv")
View(buildings.from.arcmap)
buildings.new <- merge(buildings, buildings.from.arcmap, by = "OBJECTID")
View(buildings.new)
buildings.from.arcmap$POINT_X_NEW <- buildings.from.arcmap$POINT_X
buildings.from.arcmap$POINT_Y_NEW <- buildings.from.arcmap$POINT_Y
NULL <- buildings.from.arcmap$POINT_X
buildings.from.arcmap$POINT_X <- NULL
View(buildings.from.arcmap)
buildings.from.arcmap$POINT_Y <- NULL
View(buildings.from.arcmap)
buildings.new <- merge(buildings, buildings.from.arcmap, by = "OBJECTID")
View(buildings.new)
buildings.new$POINT_X <- buildings.new$POINT_X_NEW
buildings.new$POINT_Y <- buildings.new$POINT_Y_NEW
buildings.new$POINT_Y_NEW <- NULL
buildings.new$POINT_X_NEW <- NULL
buildings <- buildings.new
rm (buildings.new)
save.image()
buildings[buildings$ID == 1030,]
calc.distance.between.buildings.double <- function(buildings.double, buildings) {
calc.distance.between.buildings.double <- numeric();
for (bIdx in 1:nrow(buildings.double)) {
id <- buildings.double$ID[bIdx];
builds <- buildings[buildings$ID == id,]
p1 <- c(builds$POINT_X[1], builds$POINT_Y[1]);
p2 <- c(builds$POINT_Y[2], builds$POINT_Y[2])
distance <- distVincentyEllipsoid(p1, p2);
calc.distance.between.buildings.double <- c(calc.distance.between.buildings.double, distance)
print(paste(bIdx, " ", url, " ", round((100*bIdx)/nrow(buildings.double), digits = 2), "%", sep = ""));
};
calc.distance.between.buildings.double;
}
double.distances <- calc.distance.between.buildings.double(buildings.double, buildings)
library("geosphere", lib.loc="~/R/i686-pc-linux-gnu-library/3.0")
double.distances <- calc.distance.between.buildings.double(buildings.double, buildings)
calc.distance.between.buildings.double <- function(buildings.double, buildings) {
calc.distance.between.buildings.double <- numeric();
for (bIdx in 1:nrow(buildings.double)) {
id <- buildings.double$ID[bIdx];
builds <- buildings[buildings$ID == id,]
p1 <- c(builds$POINT_X[1], builds$POINT_Y[1]);
p2 <- c(builds$POINT_Y[2], builds$POINT_Y[2])
distance <- distVincentyEllipsoid(p1, p2);
calc.distance.between.buildings.double <- c(calc.distance.between.buildings.double, distance)
print(paste(bIdx, " ", round((100*bIdx)/nrow(buildings.double), digits = 2), "%", sep = ""));
};
calc.distance.between.buildings.double;
}
double.distances <- calc.distance.between.buildings.double(buildings.double, buildings)
buildings.double$DISTANCE <- double.distances
View(buildings.double)
save.image()
savehistory()
builds <- buildings[buildings$ID == 1030,]
blds <- buildings[buildings$ID == 1030,]
View(blds)
blds1 <- buildings.from.arcmap[buildings.from.arcmap$ID == 1030,]
blds1 <- buildings.from.arcmap[buildings.from.arcmap$OBJECTID %in% (4071,4072),]
blds1 <- buildings.from.arcmap[buildings.from.arcmap$OBJECTID %in% list(4071,4072),]
View(blds1)
rm(blds1)
distVincentyEllipsoid(c(blds$POINT_X[1], blds$POINT_Y[1]), c(blds$POINT_X[2], blds$POINT_Y[2]))
library("geosphere", lib.loc="~/R/i686-pc-linux-gnu-library/3.0")
distVincentyEllipsoid(c(blds$POINT_X[1], blds$POINT_Y[1]), c(blds$POINT_X[2], blds$POINT_Y[2]))
rm(blds)
calc.distance.between.buildings.double <- function(buildings.double, buildings) {
calc.distance.between.buildings.double <- numeric();
for (bIdx in 1:nrow(buildings.double)) {
id <- buildings.double$ID[bIdx];
builds <- buildings[buildings$ID == id,]
p1 <- c(builds$POINT_X[1], builds$POINT_Y[1]);
p2 <- c(builds$POINT_X[2], builds$POINT_Y[2])
distance <- distVincentyEllipsoid(p1, p2);
calc.distance.between.buildings.double <- c(calc.distance.between.buildings.double, distance)
print(paste(bIdx, " ", round((100*bIdx)/nrow(buildings.double), digits = 2), "%", sep = ""));
};
calc.distance.between.buildings.double;
}
double.distances <- calc.distance.between.buildings.double(buildings.double, buildings)
buildings.double$DISTANCE <- double.distances
blds <- buildings[buildings$ID == 9911,]
View(blds)
rm(blds)
buildings.double[order(buildings.double$DISTANCE),]
buildings.double.new <- buildings.double[order(buildings.double$DISTANCE),]
View(buildings.double.new)
buildings.double <- buildings.double.new
rm(buildings.double.new)
builds <- buildings[buildings$ID == 33780,]
rm(builds)
buildings[buildings$ID == 33780,]
school2building.new[school2building.new$BUILDING_ID == 33780,]
buildings[buildings$ID == 1030,]
school2building.new[school2building.new$BUILDING_ID == 1030,]
buildings[buildings$ID == 8930,]
buildings[buildings$ID == 8930,][c(11,10)]
buildings[buildings$ID == 16348,][c(11,10)]
buildings[buildings$ID == 26569,][c(11,10)]
buildings[buildings$ID == 9258,][c(11,10)]
buildings[buildings$ID == 9258,]
buildings[buildings$ID == 26569,]$STUDENTS
buildings[buildings$ID == 9258,]$STUDENTS
buildings[buildings$ID == 16348,]$STUDENTS
buildings[buildings$ID == 10994,]$STUDENTS
buildings[buildings$ID == 12664,]$STUDENTS
calc.same.students <- function(buildings.double, buildings) {
calc.same.students <- logical();
for (bIdx in 1:nrow(buildings.double)) {
id <- buildings.double$ID[bIdx];
builds <- buildings[buildings$ID == id,]
s1 <- builds$STUDENTS[1];
s2 <- builds$STUDENTS[2];
calc.same.students <- c(calc.same.students, s1 == s2)
print(paste(bIdx, " ", round((100*bIdx)/nrow(buildings.double), digits = 2), "%", sep = ""));
};
calc.same.students;
}
css <- calc.same.students(buildings.double, buildings)
buildings.double$AMOUNT_OF_STUDENTS <- css
View(buildings.double)
rm(css)
buildings[buildings$ID == 33780,]
buildings[buildings$ID == 33805,]
buildings.double[buildings.double$AMOUNT_OF_STUDENTS==TRUE,]
buildings.double.to.remove <- buildings.double[buildings.double$AMOUNT_OF_STUDENTS==TRUE,]
buildings.double <- buildings.double[buildings.double$AMOUNT_OF_STUDENTS==FALSE,]
save.image()
View(buildings.double)
savehistory()
