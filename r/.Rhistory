#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе", breaks=seq(0, 6300, by = 250), limits=c(0, 6300)) +
scale_y_continuous(name="Количество школ", breaks=seq(0, 100, by = 25), limits=c(0, 100)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = schools$STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=schools$STUDENTS_FACTOR), binwidth = 250) +
#geom_density(alpha=.2) +
scale_x_continuous(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 100, by = 25), limits=c(0, 100)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 250) +
#geom_density(alpha=.2) +
scale_x_continuous(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 100, by = 25), limits=c(0, 100)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
#stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 250) +
#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 100, by = 25), limits=c(0, 100)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
#stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 250) +
#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе") +
#scale_y_continuous(name="Количество школ", breaks=seq(0, 100, by = 25), limits=c(0, 100)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
#stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе") +
#scale_y_continuous(name="Количество школ", breaks=seq(0, 100, by = 25), limits=c(0, 100)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 325, by = 25), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 625, by = 25), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
#scale_x_continuous(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
scale_x_discrete(name="Среднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="\nКоличество школ", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
#geom_histogram(aes(fill=cut(schools$STUDENTS_PROJECT_CATCHMENT, breaks=c(-1, 0, 500, 800, 1000, 10000), labels=c("0", "0-500", "500-800", "800-1000", ">1000")))) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
#geom_density(alpha=.2) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHEMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
colors <- data.frame(ID=c(0:5), COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"))
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=colors$COLOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
colors <- data.frame(ID=c(0:4), COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"))
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=colors$COLOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
colors <- data.frame(ID=c(0:4), COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"))
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
#scale_fill_manual("", breaks=levels(cut(districts$MEAN_STUDENTS_PER_SCHOOL, breaks=seq(99, 999, by = 100), right = FALSE)), values=colors_students_per_school_mean) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
colors <- data.frame(ID=c(0:4), COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"))
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
scale_fill_manual("", breaks=levels(STUDENTS_FACTOR), values=c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000")) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
colors <- data.frame(ID=c(0:4), COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"))
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000")) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 630)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
comment(schools$STUDENTS_PROJECT_CATCHMENT) <- "Заполняемость школ по закрепленной территории"
comment(schools$STUDENTS_PROJECT_COMPLEX) <- "Заполняемость школ по закрепленной территории и комплексу"
comment(schools$STUDENTS_PROJECT_SNIP) <- "Заполняемость школ по СНиПам"
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
save.image()
savehistory()
View(complexes)
sch <- merge(schools, complex[c(1,12)], by.x = "COMPLEX_ID", by.y = "ID", all.x = TRUE)
sch <- merge(schools, complexes[c(1,12)], by.x = "COMPLEX_ID", by.y = "ID", all.x = TRUE)
View(sch)
sch <- sch[c(2:9,1,10,14,11,12,13)]
schools <- sch
rm(sch)
save.image()
savehistory()
comment(schools$STUDENTS_PROJECT_CATCHMENT) <- "Проектная заполняемость школ по закрепленной территории"
comment(schools$STUDENTS_PROJECT_COMPLEX) <- "Проектная заполняемость школ по закрепленной территории и комплексу"
comment(schools$STUDENTS_PROJECT_SNIP) <- "Проектная заполняемость школ по СНиПам"
comment(schools$STUDENTS) <- "Реальная заполняемость школ"
save.image()
savehistory()
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
comment(schools$STUDENTS_PROJECT_CATCHMENT) <- "Проектная заполняемость школ\nпо закрепленной территории"
comment(schools$STUDENTS_PROJECT_COMPLEX) <- "Проектная заполняемость школ\nпо закрепленной территории и комплексу"
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 640)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 650)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS")
save.image()
savehistory()
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
schools <- schools[!is.na(schools[[field]]),];
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 650)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS")
save.image()
freqhist.economic  <- function(schools, field) {
labels <- c("0", "0-500", "500-800", "800-1000", ">1000")
colors <- data.frame(ID=labels, COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"));
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=labels);
schools <- schools[!is.na(schools[[field]]),];
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 650)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS")
freqhist.economic  <- function(schools, field) {
labels <- as.factor(c("0", "0-500", "500-800", "800-1000", ">1000"));
colors <- data.frame(ID=labels, COLOR = c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000"));
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=labels);
schools <- schools[!is.na(schools[[field]]),];
colors <- colors[colors$ID %in% unique(schools$STUDENTS_FACTOR),]
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 650)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
schools <- schools[!is.na(schools[[field]]),];
freqhist.economic <- ggplot(schools, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 650)) +
scale_fill_manual("", breaks=levels(schools$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS")
save.image()
savehistory()
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="\nКоличество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="\nКоличество школьников\n(тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 340)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(buildings[[field]]));
freqhist.choise;
}
save.image()
savehistory()
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic  <- function(schools, field) {
colors <- c("#730000", "#e60000", "#55ff00", "#38a800", "#1b5000");
schools$STUDENTS_FACTOR <- cut(schools[[field]],
breaks=c(-1, 0, 500, 800, 1000, 10000),
labels=c("0", "0-500", "500-800", "800-1000", ">1000"));
schools.to.graph <- schools[!is.na(schools[[field]]),];
freqhist.economic <- ggplot(schools.to.graph, aes(x = STUDENTS_FACTOR)) +
geom_histogram(aes(fill=STUDENTS_FACTOR), binwidth = 1) +
scale_x_discrete(name="\nСреднее число обучающихся в школе") +
scale_y_continuous(name="Количество школ\n", breaks=seq(0, 600, by = 50), limits=c(0, 650)) +
scale_fill_manual("", breaks=levels(schools.to.graph$STUDENTS_FACTOR), values=colors) +
stat_bin(binwidth=1, geom="text", aes(label=(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(schools[[field]]));
freqhist.economic;
}
freqhist.economic(schools, "STUDENTS_PROJECT_SNIP")
freqhist.economic(schools, "STUDENTS_PROJECT_CATCHMENT")
freqhist.economic(schools, "STUDENTS_PROJECT_COMPLEX")
freqhist.economic(schools, "STUDENTS")
save.image()
savehistory()
freqhist_asarea_students
rm(freqhist_asarea_students)
rm(freqhist_not_accessible_students_by_google)
rm(freqhist_not_accessible_students_by_radius)
rm(freqhist_school_rad_for_1000_students)
rm(freqhist_school_rad_for_500_students)
rm(freqhist_school_rad_for_800_students)
rm(freqhist_students_per_school_mean_hist)
rm(scat_accessible_students_by_radius_ON_students_per_school_mean)
rm(scat_not_accessible_students_by_google_ON_students_per_school_mean)
rm(scat_not_accessible_students_by_radius_ON_students_per_school_mean)
rm(colors_schools_radius)
rm(colors_students_per_school_mean)
rm(data_colnames)
rm(data_colnames_eng)
save.image()
savehistory()
