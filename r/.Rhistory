subset(schools.without.assigned.area, OBJECTID %in% subset(schools, COMPLEX_ID == 499)$OBJECTID)$OBJECTID
save.image()
savehistory()
agg <- aggregate(HOUSE_ID~SCHOOL_NEW_ID, school2building, length)
View(agg)
schools.new <- merge(schools, agg, by.x="NEW_ID", by.y="SCHOOL_NEW_ID", all = TRUE)
View(schools.new)
schools.new$HOUSE_ID_COUNT[is.na(schools.new$HOUSE_ID_COUNT)] <- 0
agg$HOUSE_ID_COUNT <- agg$HOUSE_ID;
schools.new <- merge(schools, agg, by.x="NEW_ID", by.y="SCHOOL_NEW_ID", all = TRUE)
View(schools.new)
rm(schools.new)
schools.new <- merge(schools, agg, by.x="NEW_ID", by.y="SCHOOL_NEW_ID", all = TRUE)
View(schools.new)
rm(schools.new)
agg <- agg[c(1,3)]
schools.new <- merge(schools, agg, by.x="NEW_ID", by.y="SCHOOL_NEW_ID", all = TRUE)
schools.new$HOUSE_ID_COUNT[is.na(schools.new$HOUSE_ID_COUNT)] <- 0
assigned.area.best.school.ids <- function(schools, school2building) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools)) {
complexId <- schools$COMPLEX_ID[sIdx];
ss <- subset(schools, COMPLEX_ID == complexId)[order(HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
rbind(assigned.area.best.school.ids, NA);
};
assigned.area.best.school.ids;
};
}
assigned.area.best.school.ids <- function(schools) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools)) {
complexId <- schools$COMPLEX_ID[sIdx];
ss <- subset(schools, COMPLEX_ID == complexId)[order(HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
rbind(assigned.area.best.school.ids, NA);
};
assigned.area.best.school.ids;
};
}
aa <- assigned.area.best.school.ids(schools.new)
assigned.area.best.school.ids <- function(schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.new)) {
complexId <- schools$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId)[order(HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
rbind(assigned.area.best.school.ids, NA);
};
assigned.area.best.school.ids;
};
}
aa <- assigned.area.best.school.ids(schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId)[order(HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
rbind(assigned.area.best.school.ids, NA);
};
assigned.area.best.school.ids;
};
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
schools.without.assigned.area$COMPLEX_ID[3]
subset(schools.new, COMPLEX_ID == schools.without.assigned.area$COMPLEX_ID[0])
subset(schools.new, COMPLEX_ID == schools.without.assigned.area$COMPLEX_ID[0])[order(HOUSE_ID_COUNT)]
save.image()
savehistory()
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId)[order(HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
debugSource('/media/WORK/hse/school-accessibility/r/generate_school_id.R')
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
schools.new
View(schools.new)
subset(schools.new, COMPLEX_ID == complexId)
sss <- subset(schools.new, COMPLEX_ID == complexId)
View(sss)
sss[order(HOUSE_ID_COUNT, decreasing = TRUE)]
sss[order(HOUSE_ID_COUNT)]
sss[order(HOUSE_ID_COUNT)]
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
aa
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE)];
if (nrow(ss) != 0) {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
aa
debugSource('/media/WORK/hse/school-accessibility/r/generate_school_id.R')
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
View(ss)
rm(sss)
View(ss)
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
View(ss)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- order(ss$HOUSE_ID_COUNT, decreasing = TRUE);
if (nrow(ss) != 0) {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
ss <- subset(schools.new, COMPLEX_ID == 499);
order(ss$HOUSE_ID_COUNT, decreasing = TRUE)
ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE)]
ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),]
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
if (nrow(ss) != 0) {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss$SCHOOL_NEW_ID[1]);
} else {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
aa
ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),]
aa <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),]
aa
View(ss)
aa <- ss[order(ss$HOUSE_ID_COUNT, decreasing = FALSE),]
View(ss)
aa
View(aa)
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = FALSE),]
View(ss)
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = FALSE),]
View(ss)
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),]
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),]
View(ss)
nrow(ss)
nrow(ss) != 0
ss$SCHOOL_NEW_ID[1]
ss$NEW_ID[1]
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
if (nrow(ss) != 0) {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss$NEW_ID[1]);
} else {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
aa
View(ss)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 11)];
if (nrow(ss) != 0) {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss[1]);
} else {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
aa
ss
ss[c(1, 11)]
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
if (nrow(ss) != 0) {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss[1]);
} else {
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, NA);
};
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
View(aa)
rm (ss)
rm (a)
rm (aa)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$ID <- id;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
View(aa)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID]
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID];
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
aa
View(aa)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
if (nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0) {
ss$ZERO_ASSIGNED <- TRUE;
} else {
ss$ZERO_ASSIGNED <- FALSE;
}
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
ss$ZERO_ASSIGNED <- nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
ss$ZERO_ASSIGNED <- nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
print (nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0);
ss$ZERO_ASSIGNED <- nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
#  ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
print (nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0);
ss$SELF <- ss$SCHOOL_ID == ss$ASSIGNED_SCHOOL_ID;
ss$ZERO_ASSIGNED <- nrow(ss) == 1 & ss$HOUSE_ID_COUNT[1] == 0;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
#  ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
ss$SELF <- ss$SCHOOL_ID == ss$ASSIGNED_SCHOOL_ID;
ss$ZERO_ASSIGNED <- nrow(ss) >= 1 & ss$HOUSE_ID_COUNT[1] == 0;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
#   ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
ss$SELF <- ss$SCHOOL_ID == ss$ASSIGNED_SCHOOL_ID;
ss$ZERO_ASSIGNED <- nrow(ss) >= 1 & ss$HOUSE_ID_COUNT[1] == 0;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss[1]);
#   assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
assigned.area.best.school.ids <- function(schools.without.assigned.area, schools.new) {
assigned.area.best.school.ids <- data.frame();
for (sIdx in 1:nrow(schools.without.assigned.area)) {
id <- schools.without.assigned.area$NEW_ID[sIdx];
complexId <- schools.without.assigned.area$COMPLEX_ID[sIdx];
ss <- subset(schools.new, COMPLEX_ID == complexId);
ss <- ss[order(ss$HOUSE_ID_COUNT, decreasing = TRUE),];
ss <- ss[c(1, 12)];
ss$SCHOOL_ID <- id;
ss$ASSIGNED_SCHOOL_ID <- ss$NEW_ID;
ss <- ss[c(3,4,2)];
#   ss <- ss[ss$SCHOOL_ID != ss$ASSIGNED_SCHOOL_ID,];
ss$SELF <- ss$SCHOOL_ID == ss$ASSIGNED_SCHOOL_ID;
ss$ZERO_ASSIGNED <- nrow(ss) >= 1 & ss$HOUSE_ID_COUNT[1] == 0;
assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss[1,]);
#   assigned.area.best.school.ids <- rbind(assigned.area.best.school.ids, ss);
};
assigned.area.best.school.ids;
}
aa <- assigned.area.best.school.ids(schools.without.assigned.area, schools.new)
nrow(subset(aa, HOUSE_ID_COUNT==1))
nrow(subset(aa, HOUSE_ID_COUNT==1,))
nrow(subset(aa, HOUSE_ID_COUNT==0,))
save.image()
savehistory()
