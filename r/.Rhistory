<<<<<<< HEAD
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size = 4,width = 0.9, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size = 4,width = 2, vjust=-0.5) +
theme(legend.position="none");
=======
>>>>>>> f717f8aa8e9447e084c08f080993494f5cc15060
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size = 4,weight = 2, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
geom_text(binwidth=1, aes(label=round(..count..)), size = 4,weight = 2, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
geom_text(binwidth=1,  size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
#stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
geom_text(size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size = 3, vjust=-1.0) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text",  aes(label=round(..count..)), size=4, vjust=-0.5) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=4, vjust=-0.5) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), fontface="italic",size=4, vjust=-0.5) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), fontface="bold",size=4, vjust=-0.5) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=4, fontface="bold", vjust=-0.5) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, fontface="bold", vjust=-0.5) +
#geom_text(binwidth=1, aes(label=round(..count..)), size = 4, vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_COMPLEX")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="red", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_COMPLEX")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
save.image()
savehistory()
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle("Plant growth");
freqhist.choise;
}
savehistory()
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle("Выбор школ в радиусе");
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
comment(buildings$ACCESSIBLE_SCHOOLS_R500)
comment(buildings[["ACCESSIBLE_SCHOOLS_R500"]])
comment(buildings$ACCESSIBLE_SCHOOLS_R500) <- "Выбор школ радиусе 500 м"
comment(buildings$ACCESSIBLE_SCHOOLS_R800) <- "Выбор школ в радиусе 800 м"
comment(buildings$ACCESSIBLE_SCHOOLS_R500) <- "Выбор школ в радиусе 500 м"
comment(buildings$ACCESSIBLE_SCHOOLS_R1000) <- "Выбор школ в радиусе 1000 м"
comment(buildings$ACCESSIBLE_SCHOOLS_AREA) <- "Выбор школ в рамках закрепленной территории"
comment(buildings$ACCESSIBLE_SCHOOLS_COMPLEX) <- "Выбор школ в рамках закрепленной территории и комплекса"
comment(buildings[["ACCESSIBLE_SCHOOLS_R500"]])
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников (тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(buildings[[field]]));
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_COMPLEX")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
comment(buildings$ACCESSIBLE_SCHOOLS_R800)
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_СЩЬЗДУЧ")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_COMPLEX")
save.image()
savehistory()
View(buildings)
View(buildings)
buildings1 <- read.csv("../csv/buildings.csv", stringsAsFactors = FALSE, na.strings = "")
View(buildings1)
encoding
Sys.getlocale()
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
View(buildings1)
View(buildings)
rm(buildings1)
View(buildings)
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
View(buildings)
defaults write org.R-project.R LC_CTYPE ru_RU.UTF-8
system("locale")
View(buildings)
View(buildings)
Sys.getlocale()
buildings$ADDRESS
system("env")
Sys.getlocale()
Sys.getlocale(category = "LC_CTYPE")
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
View(buildings)
installed.packages()
remove.packages("knitr")
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_СЩЬЗДУЧ")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
update.packages(checkBuilt=TRUE)
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
installed.packages()
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_COMPLEX")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников\n(тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 325)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(buildings[[field]]));
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_COMPLEX")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_AREA")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R500")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R800")
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_R1000")
save.image()
savehistory()
View(buildings)
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
View(buildings)
resdistrict <- edzones
rm(edzones)
resdistricts <- resdistrict
rm(resdistrict)
buildings$RESDISTRICT_ID <- buildings$EDZONE_ID
buildings1 <- buildings[c(1:9,18,11:17)]
View(buildings1)
buildings <- buildings[c(1:9,18,11:17)]
rm(buildings1)
rm(choise.histogramm.table)
school.blocks$RESDISTRICT_ID <- school.blocks$EDZONE_ID
school.blocks1 <- school.blocks[c(1:8,12,10,11)]
school.blocks <- school.blocks[c(1:8,12,10,11)]
rm(school.blocks1)
save.image()
savehistory()
rm(freqhist.choise1)
rm(freqhist.choise.catchment)
save.image()
View(buildings)
savehistory()
resdistrict.school2building = function(buildings, schools, school.blocks){
resdistrict.school2building <- data.frame();
for (sIdx in 1:nrow(schools)) {
sId <- schools$ID[sIdx];
rdIds <- unique(school.blocks[school.blocks$SCHOOL_ID == sId,]$RESDISTRICT_ID);
df <- data.frame(BUILDING_ID = buildings[buildings$RESDISTRICT_ID %in% rdIds,]$ID);
df$SCHOOL_ID <- sId;
resdistrict.school2building <- rbind(resdistrict.school2building, df);
}
resdistrict.school2building <- resdistrict.school2building[c(2,1)];
resdistrict.school2building;
}
resdistrict.school2building = function(buildings, schools, school.blocks){
resdistrict.school2building <- data.frame();
for (sIdx in 1:nrow(schools)) {
sId <- schools$ID[sIdx];
rdIds <- unique(school.blocks[school.blocks$SCHOOL_ID == sId,]$RESDISTRICT_ID);
df <- data.frame(BUILDING_ID = buildings[buildings$RESDISTRICT_ID %in% rdIds,]$ID);
df$SCHOOL_ID <- sId;
resdistrict.school2building <- rbind(resdistrict.school2building, df);
<<<<<<< HEAD
}
resdistrict.school2building <- resdistrict.school2building[c(2,1)];
resdistrict.school2building <- resdistrict.school2building[order(resdistrict.school2building$SCHOOL_ID),]
resdistrict.school2building;
}
=======
}
resdistrict.school2building <- resdistrict.school2building[c(2,1)];
resdistrict.school2building <- resdistrict.school2building[order(resdistrict.school2building$SCHOOL_ID),]
resdistrict.school2building;
}
>>>>>>> f717f8aa8e9447e084c08f080993494f5cc15060
school2building.resdistrict <- resdistrict.school2building(buildings, schools, school.blocks)
debugSource('/media/WORK/hse/school-accessibility/r/resdistrict.school2building.R')
school2building.resdistrict <- resdistrict.school2building(buildings, schools, school.blocks)
View(df)
View(df)
resdistrict.school2building = function(buildings, schools, school.blocks){
resdistrict.school2building <- data.frame();
for (sIdx in 1:nrow(schools)) {
sId <- schools$ID[sIdx];
rdIds <- unique(school.blocks[school.blocks$SCHOOL_ID == sId,]$RESDISTRICT_ID);
df <- data.frame(BUILDING_ID = buildings[buildings$RESDISTRICT_ID %in% rdIds,]$ID);
if (nrow(df) == 0) {
next;
}
df$SCHOOL_ID <- sId;
resdistrict.school2building <- rbind(resdistrict.school2building, df);
print(paste(sIdx, " ", schools$NAME[sIdx], " ", round((100*sIdx)/nrow(schools), digits = 2), "%", sep = ""));
}
resdistrict.school2building <- resdistrict.school2building[c(2,1)];
resdistrict.school2building <- resdistrict.school2building[order(resdistrict.school2building$SCHOOL_ID),]
resdistrict.school2building;
}
school2building.resdistrict <- resdistrict.school2building(buildings, schools, school.blocks)
View(school2building.resdistrict)
save.image()
savehistory()
write.csv(school2building.resdistrict, "../csv/school2building.resdistrict.csv", row.names = FALSE)
features.connection.resdistrict <- generate.connection.features(buildings, schools, school.blocks, school2building.resdistrict)
library("geosphere", lib.loc="~/R/i686-pc-linux-gnu-library/3.0")
features.connection.resdistrict <- generate.connection.features(buildings, schools, school.blocks, school2building.resdistrict)
View(buildings)
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
View(buildings)
write.csv(features.connection.resdistrict, "../csv/features.connection.resdistrict.csv", row.names = FALSE)
resdistricts$SCHOOL_COUNT <- sapply(resdistricts$ID, {function(x) nrow(unique(school.blocks[school.blocks$RESDISTRICT_ID == x,]$SCHOOL_ID))})
View(resdistricts)
school.blocks[school.blocks$RESDISTRICT_ID == 1,]
school.blocks[school.blocks$RESDISTRICT_ID == 2,]
school.blocks[school.blocks$RESDISTRICT_ID == 2,]$SCHOOL_ID
unique(school.blocks[school.blocks$RESDISTRICT_ID == 2,]$SCHOOL_ID)
length(unique(school.blocks[school.blocks$RESDISTRICT_ID == 2,]$SCHOOL_ID))
resdistricts$SCHOOL_COUNT <- sapply(resdistricts$ID, {function(x) length(unique(school.blocks[school.blocks$RESDISTRICT_ID == x,]$SCHOOL_ID))})
buildings <- merge(buildings, resdistricts[c(1,4)], by.x = "RESDISTRICT_ID", by.y="ID")
View(buildings)
buildings <- buildings[c(2:10,1,11:18)]
buildings <- buildings[order(buildings$ID),]
View(buildings)
buildings$ACCESSIBLE_SCHOOLS_RESDISTRICT <- buildings$SCHOOL_COUNT
View(buildings)
buildings$SCHOOL_COUNT <- NULL
View(buildings)
<<<<<<< HEAD
save.image()
savehistory()
write.csv(buildings, file = "../csv/buildings.csv", na = "", row.names = FALSE)
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_RESDISTRICT")
comment(buildings$ACCESSIBLE_SCHOOLS_RESDISTRICT) <- "Выбор школ в рамках жилого района"
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_RESDISTRICT")
=======
save.image()
savehistory()
write.csv(buildings, file = "../csv/buildings.csv", na = "", row.names = FALSE)
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_RESDISTRICT")
comment(buildings$ACCESSIBLE_SCHOOLS_RESDISTRICT) <- "Выбор школ в рамках жилого района"
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_RESDISTRICT")
save.image()
savehistory()
View(school2building.resdistrict)
View(school2building.resdistrict)
Sys.setlocale("LC_CTYPE", "ru_RU.UTF-8")
View(buildings)
school2building.r500.new <- school2building.r500
rm(school2building.r500.new)
school2building.snip <- merge(school2building.resdistrict, school2building.r500, by=c("SCHOOL_ID", "BUILDING_ID"), all=FALSE)
View(school2building.snip)
school2building.snip[school2building.snip$BUILDING_ID == 24022,]
nrow(school2building.snip[school2building.snip$BUILDING_ID == 24022,])
buildings$ACCESSIBLE_SCHOOLS_SNIP <- sapply(buildings$ID, {function(x) nrow(school2building.snip[school2building.snip$BUILDING_ID == x,])})
save.image()
savehistory()
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_SNIP")
comment(buildings$ACCESSIBLE_SCHOOLS_SNIP) <- "Выбор школ по СНиПам"
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_SNIP")
freqhist.choise  <- function(buildings, field) {
buildings$STUDENTS <- buildings$STUDENTS/1000;
colors <- data.frame(ID=c(0:19), COLOR = c("#c2523c", "#cc5e33", "#d97529", "#e68e1c", "#eda813",
"#f2c00c", "#f7d707", "#fcf403", "#c6f700", "#7bed00",
"#35e300", "#02d609", "#0ec441", "#17b36d", "#1e9e84",
"#1e9094", "#166d8a", "#114d82", "#0c2f7a", "#081e4e"))
colors <- colors[colors$ID %in% unique(buildings[[field]]),]
freqhist.choise <- ggplot(buildings, aes_string(x=field, weight = "STUDENTS")) +
geom_histogram(fill=colors$COLOR, binwidth = 1) +
scale_x_discrete(name="Количество школ", expand = c(0,2), limits=c(0:19)) +
scale_y_continuous(name="Количество школьников\n(тыс. чел.)", breaks=seq(0, 325, by = 25), limits=c(0, 340)) +
stat_bin(binwidth=1, geom="text", aes(label=round(..count..)), size=3.5, colour="#4C4646", fontface="bold", vjust=-0.5) +
theme(legend.position="none") +
ggtitle(comment(buildings[[field]]));
freqhist.choise;
}
freqhist.choise(buildings, "ACCESSIBLE_SCHOOLS_SNIP")
write.csv(buildings, file = "../csv/model/buildings.csv", na = "", row.names = FALSE)
write.csv(school2building.snip, "../csv/school2building/school2building.snip.csv", row.names = FALSE)
features.connection.snip <- generate.connection.features(buildings, schools, school.blocks, school2building.snip)
library("geosphere", lib.loc="~/R/i686-pc-linux-gnu-library/3.0")
features.connection.snip <- generate.connection.features(buildings, schools, school.blocks, school2building.snip)
write.csv(features.connection.snip, "../csv/features/features.connection.snip.csv", row.names = FALSE)
>>>>>>> f717f8aa8e9447e084c08f080993494f5cc15060
save.image()
savehistory()
