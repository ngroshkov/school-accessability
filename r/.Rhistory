for(con in all_cons) all_res<-dbListResults(con)
for(con in all_cons)
all_res <- dbListResults(con)
for(con in all_cons)
dbGetQuery(con, "show processlist")
calc.school2building.dist <- function(buildings, schools, school.blocks) {
calc.school2building.dist <- data.frame();
for (sIdx in 1:nrow(schools)) {
sId <- schools$ID[sIdx];
sblocks <- school.blocks[school.blocks$SCHOOL_ID == sId,];
dists <- integer();
for (bIdx in 1:nrow(buildings)) {
bId <- buildings$ID[bIdx];
bp <- c(buildings$POINT_X[bIdx], buildings$POINT_Y[bIdx]);
sbdists <- numeric();
for (sbIdx in 1:nrow(sblocks)) {
sbp <- c(sblocks$POINT_X[sbIdx], sblocks$POINT_Y[sbIdx]);
sbdists <- c(sbdists, distVincentyEllipsoid(bp, sbp));
}
dist <- as.integer(round(min(sbdists)));
dists <- c(dists, dist);
}
df <- data.frame(BUILDING_ID = buildings$ID)
df$SCHOOL_ID <- sId;
df$DIST <- dists;
calc.school2building.dist <- rbind(calc.school2building.dist, df);
print(paste(sIdx, " ", round((100*sIdx)/nrow(schools), digits = 2), "%", sep = ""));
};
calc.school2building.dist;
}
calc.school2building.economic <- function(buildings, schools, minSchoolStudents = 500) {
n <- 1000;
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
con <- dbConnect(MySQL(), user = 'root', password = 'Thisistheend', host = 'localhost', dbname='SCHOOL_ACCESSIBILITY');
rs <- dbSendQuery(con, "select * from SCHOOL2BUILDING_DIST ORDER BY DIST;");
# rs <- dbSendQuery(con, "select * from SCHOOL2BUILDING_DIST limit 2500;");
it <- 0;
while (TRUE) {
rsdata <- fetch(rs, n);
for (rIdx in 1:nrow(rsdata)) {
sId <- rsdata$SCHOOL_ID[rIdx];
bId <- rsdata$BUILDING_ID[rIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
if (schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <-
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL + students;
}
acquired.buildings <- c(acquired.buildings, bId);
}
it <- it + n;
print(paste(Sys.time(), " ", round(it/48649200, digits = 2), "%", sep = "")));
if (nrow(rsdata) < n) {
break;
}
}
dbClearResult(rs);
dbDisconnect(con);
calc.school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic;
}
calc.school2building.economic <- function(buildings, schools, minSchoolStudents = 500) {
n <- 1000;
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
con <- dbConnect(MySQL(), user = 'root', password = 'Thisistheend', host = 'localhost', dbname='SCHOOL_ACCESSIBILITY');
rs <- dbSendQuery(con, "select * from SCHOOL2BUILDING_DIST ORDER BY DIST;");
# rs <- dbSendQuery(con, "select * from SCHOOL2BUILDING_DIST limit 2500;");
it <- 0;
while (TRUE) {
rsdata <- fetch(rs, n);
for (rIdx in 1:nrow(rsdata)) {
sId <- rsdata$SCHOOL_ID[rIdx];
bId <- rsdata$BUILDING_ID[rIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
if (schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <-
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL + students;
}
acquired.buildings <- c(acquired.buildings, bId);
}
it <- it + n;
print(paste(Sys.time(), " ", round(it/48649200, digits = 2), "%", sep = ""));
if (nrow(rsdata) < n) {
break;
}
}
dbClearResult(rs);
dbDisconnect(con);
calc.school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic;
}
rm(all_cons)
rm(con)
school2building.economic <- calc.school2building.economic(buildings, schools)
calc.school2building.economic <- function(buildings, schools, minSchoolStudents = 500) {
n <- 10000;
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
con <- dbConnect(MySQL(), user = 'root', password = 'Thisistheend', host = 'localhost', dbname='SCHOOL_ACCESSIBILITY');
rs <- dbSendQuery(con, "select * from SCHOOL2BUILDING_DIST ORDER BY DIST;");
# rs <- dbSendQuery(con, "select * from SCHOOL2BUILDING_DIST limit 2500;");
it <- 0;
while (TRUE) {
rsdata <- fetch(rs, n);
for (rIdx in 1:nrow(rsdata)) {
sId <- rsdata$SCHOOL_ID[rIdx];
bId <- rsdata$BUILDING_ID[rIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
}
acquired.buildings <- c(acquired.buildings, bId);
}
it <- it + n;
print(paste(Sys.time(), " ", round(it/48649200, digits = 2), "%", sep = ""));
if (nrow(rsdata) < n) {
break;
}
}
dbClearResult(rs);
dbDisconnect(con);
calc.school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools)
tail(head(school2building.dist, 1000000),1)
tail(head(school2building.dist, 1000001),1)
tail(head(school2building.dist, 1000002),1)
tail(head(school2building.dist, 1000003),1)
tail(head(school2building.dist, 1000004),1)
tail(head(school2building.dist, 1000005),1)
tail(head(school2building.dist, 1000006),1)
tail(head(school2building.dist, 1000010),1)
tail(head(school2building.dist, 1000020),1)
tail(head(school2building.dist, 1000030),1)
tail(head(school2building.dist, 1000040),1)
tail(head(school2building.dist, 1000100),1)
tail(head(school2building.dist, 1000200),1)
tail(head(school2building.dist, 1000300),1)
tail(head(school2building.dist, 1000500),1)
tail(head(school2building.dist, 1000400),1)
tail(head(school2building.dist, 1000350),1)
tail(head(school2building.dist, 1000310),1)
tail(head(school2building.dist, 1000320),1)
tail(head(school2building.dist, 1000330),1)
tail(head(school2building.dist, 1000340),1)
school2building.dist[school2building.dist$DIST == 2838,]
nrow(school2building.dist[school2building.dist$DIST == 2838,])
nrow(school2building.dist[school2building.dist$DIST == 300,])
nrow(school2building.dist[school2building.dist$DIST == 800,])
nrow(school2building.dist[school2building.dist$DIST == 1000,])
nrow(school2building.dist[school2building.dist$DIST == 1500,])
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
}
acquired.buildings <- c(acquired.buildings, bId);
if (s2bIdx == 1000000) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = false);
}
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
}
acquired.buildings <- c(acquired.buildings, bId);
if (s2bIdx == 1000000) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = false);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = false);
}
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
35 %% 10
1000000 %% 100000
1000001 %% 100000
500001 %% 100000
500000 %% 100000
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
}
acquired.buildings <- c(acquired.buildings, bId);
if (s2bIdx %% 100000 == 0) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = false);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = false);
}
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
if (s2bIdx %% 100000 == 0) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = false);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = false);
}
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
}
acquired.buildings <- c(acquired.buildings, bId);
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
save.image()
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
write.csv(schools, "../csv/schools-current-fill.csv", row.names = FALSE);
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
if (s2bIdx %% 100000 == 0) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = FALSE);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = FALSE);
}
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill < minSchoolStudents) {
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
}
acquired.buildings <- c(acquired.buildings, bId);
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
if (s2bIdx %% 100000 == 0) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = FALSE);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = FALSE);
}
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
students <- buildings[buildings$ID == bId,]$STUDENTS;
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill >= minSchoolStudents) {
next;
}
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
acquired.buildings <- c(acquired.buildings, bId);
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
school2building.economic <- read.csv("../school2building-ecomomic-5.csv")
school2building.dist.tail <- tail(school2building.dist, nrow(school2building.dist) - 599999)
result.building.ids <- school2building.economic$SCHOOL_ID;
class(school2building.dist$SCHOOL_ID)
school2building.dist$SCHOOL_ID_INT <- as.integer(school2building.dist$SCHOOL_ID)
View(school2building.dist)
school2building.dist$SCHOOL_ID_FAC <- as.numeric(as.character(school2building.dist$SCHOOL_ID))
school2building.dist[is.na(school2building.dist$SCHOOL_ID_FAC),]
school2building.dist <- school2building.dist[!is.na(school2building.dist$SCHOOL_ID_FAC),]
save.image()
school2building.dist$SCHOOL_ID <- school2building.dist$SCHOOL_ID_FAC
school2building.dist$BUILDING_ID <- as.numeric(as.character(school2building.dist$BUILDING_ID))
school2building.dist$DIST <- as.numeric(as.character(school2building.dist$DIST))
school2building.dist$DIST <- as.integer(school2building.dist$DIST)
school2building.dist$BUILDING_ID <- as.integer(school2building.dist$BUILDING_ID)
school2building.dist$SCHOOL_ID <- as.integer(school2building.dist$SCHOOL_ID)
school2building.dist$SCHOOL_ID_INT <- NULL
school2building.dist$SCHOOL_ID_FAC <- NULL
save.image()
rm(school2building.economic)
rm(school2building.dist.tail)
save.image()
buildings$ADDRESS <- as.character(buildings$ADDRESS)
complexes$NUMB <- as.character(complexes$NUMB)
complexes$NUMB <- as.number(complexes$NUMB)
complexes$NUMB <- as.integer(complexes$NUMB)
complexes$NAME <- as.integer(complexes$NAME)
complexes.new <- read.csv("../csv/complexes.csv")
complexes$NUMB <- complexes.new$NUMB
View(complexes)
complexes$NAME <- complexes.new$NAME
View(complexes)
complexes$NAME <- as.character(complexes$NAME)
complexes$WEBSITE <- as.character(complexes$WEBSITE)
rm(complexes.new)
save.image()
school.blocks$NAME <- as.character(school.blocks$NAME)
school.blocks$ADDRESS <- as.character(school.blocks$ADDRESS)
save.image()
schools$NAME <- as.character(schools$NAME)
schools$ADDRESS <- as.character(schools$ADDRESS)
save.image()
calc.school2building.economic <- function(buildings, schools, school2building.dist, minSchoolStudents = 500) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
acquired.buildings <- integer();
result.school.ids <- integer();
result.building.ids <- integer();
for (s2bIdx in 1:nrow(school2building.dist)) {
if (s2bIdx %% 100000 == 0) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = FALSE);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = FALSE);
}
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% acquired.buildings) {
next;
}
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill >= minSchoolStudents) {
next;
}
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
students <- buildings[buildings$ID == bId,]$STUDENTS;
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
acquired.buildings <- c(acquired.buildings, bId);
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
school2building.economic <- calc.school2building.economic(buildings, schools, school2building.dist)
save.image()
schools.current.fill <- school2building.economic[1]
schools.current.fill <- school2building.economic[1,]
schools.current.fill <- school2building.economic[[1]]
school2building.economic1 <- school2building.economic[[2]]
school2building.economic <- school2building.economic[[2]]
rm(school2building.economic1)
save.image()
length(unique(school2building.economic$BUILDING_ID))
calc.school2building.economic <- function(buildings, schools, school2building.dist,
schools.current.fill, school2building.economic, minSchoolStudents = 500) {
if (is.null(schools.current.fill)) {
schools.current.fill <- data.frame(ID = schools$ID, CURRENT_FILL = 0);
}
result.school.ids <- integer();
result.building.ids <- integer();
if (!is.null(school2building.economic)) {
result.school.ids <- school2building.economic$SCHOOL_ID;
result.building.ids <- school2building.economic$BUILDING_ID;
}
for (s2bIdx in 1:nrow(school2building.dist)) {
if (s2bIdx %% 100000 == 0) {
write.csv(data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids), "../csv/school2building-ecomomic.csv", row.names = FALSE);
write.csv(schools.current.fill, "../csv/schools-current-fill.csv", row.names = FALSE);
}
sId <- school2building.dist$SCHOOL_ID[s2bIdx];
bId <- school2building.dist$BUILDING_ID[s2bIdx];
if (bId %in% result.building.ids) {
next;
}
currentFill <- schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL;
if (currentFill >= minSchoolStudents) {
next;
}
result.school.ids <- c(result.school.ids, sId);
result.building.ids <- c(result.building.ids, bId);
students <- buildings[buildings$ID == bId,]$STUDENTS;
schools.current.fill[schools.current.fill$ID==sId,]$CURRENT_FILL <- currentFill + students;
print(paste(s2bIdx, " ", round((100*s2bIdx)/nrow(school2building.dist), digits = 2), "%", sep = ""));
}
school2building.economic <- data.frame(SCHOOL_ID = result.school.ids, BUILDING_ID = result.building.ids);
calc.school2building.economic <- list(schools.current.fill, school2building.economic);
calc.school2building.economic;
}
schools.current.fill[schools.current.fill$CURRENT_FILL < 500,]
schools.current.fill[schools.current.fill$CURRENT_FILL < 500,][order(schools.current.fill$CURRENT_FILL),]
View(schools.current.fill)
schools.current.fill[order(schools.current.fill$CURRENT_FILL),][schools.current.fill$CURRENT_FILL < 500,]
schools.current.fill[schools.current.fill$CURRENT_FILL < 500,]
schools.current.fill[schools.current.fill$CURRENT_FILL < 500,]$ID
school2building.dist1 <- read.csv("../csv/school2building-dist-rest.csv")
View(school2building.dist1)
school2building.economic.new <- calc.school2building.economic(buildings, schools, school2building.dist1, schools.current.fill, school2building.economic)
schools.current.fill.new <- school2building.economic[[1]]
schools.current.fill.new <- school2building.economic.new[[1]]
View(schools.current.fill.new)
school2building.economic.new1 <- school2building.economic.new[[2]]
school2building.economic.new <- school2building.economic.new[[2]]
rm(school2building.economic.new1)
schools.current.fill <- schools.current.fill.new
rm(schools.current.fill.new)
school2building.dist <- rbind(school2building.dist, school2building.dist1)
rm(school2building.dist1)
school2building.economic <- school2building.economic.new
rm(school2building.economic.new)
save.image()
school2building.assign <- school2building
rm(schools.current.fill)
rm(result.building.ids)
rm(radiuses500, radiuses800, radiuses1000)
school2building.assigned <- school2building
rm(school2building, school2building.assign)
save.image()
savehistory()
write.csv(school2building.economic, "../csv/school2building-economic.csv", row.names = FALSE, na = "")
save.image()
savehistory()
