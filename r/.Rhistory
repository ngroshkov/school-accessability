geom_smooth(method=lm) +
geom_text(aes(x = 1, y = 1, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_radius, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
#scale_colour_manual(values = c("red","green")) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_radius), max(data$not_accessible_area_by_radius) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 3000, y = 1, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_radius, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
#scale_colour_manual(values = c("red","green")) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_radius), max(data$not_accessible_area_by_radius) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 2000, y = 1, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_radius, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
#scale_colour_manual(values = c("red","green")) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_radius), max(data$not_accessible_area_by_radius) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 2000, y = 1000, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_radius, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
#scale_colour_manual(values = c("red","green")) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_radius), max(data$not_accessible_area_by_radius) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 2500, y = 800, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm, se=FALSE) +
geom_text(aes(x = 2500, y = 800, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
lm_eqn = function(df, x, y){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(R)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean), fontface=3), parse = TRUE) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean), fontface=4), parse = TRUE) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean), fontface=10), parse = TRUE) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", lineheight=.8) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", lineheight=1) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", lineheight=10) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", lineheight=100) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", size=10) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", size=8) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", size=6) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", size=8) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8750, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", size=8) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8000, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Times", fontface="italic", size=8) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8000, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="Arial", fontface="italic", size=8) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8000, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), family="Arial", fontface="italic", size=8 ) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8000, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=8, ) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
lm_eqn = function(df, x, y){
m = lm(y ~ x, df);
eq <- substitute(italic(Y) == a + b %.% italic(X)*","~~italic(R)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 8000, y = 550, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 4000, y = 1000, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 7000, y = 1000, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 6500, y = 1000, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 6600, y = 1000, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 6700, y = 1000, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 6700, y = 1100, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 6700, y = 1050, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_google, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_google), max(data$not_accessible_area_by_google) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 6750, y = 1050, label = lm_eqn(data, data$not_accessible_area_by_google, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы по пешеходным маршрутам") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_radius, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
#scale_colour_manual(values = c("red","green")) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_radius), max(data$not_accessible_area_by_radius) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 2500, y = 800, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean <- ggplot(data, aes(x=data$not_accessible_area_by_radius, y=data$students_per_school_mean)) +
geom_point(aes(color=cut(data$students_per_school_mean, breaks=seq(99, 999, by = 100)), size=4)) +
#geom_text(aes(label=rownames(data)), colour="black", size=3, hjust=-0.1, vjust=0) +
scale_colour_manual("", values=colors_students_per_school_mean) +
#scale_colour_manual(values = c("red","green")) +
scale_x_continuous(limits = c(min(data$not_accessible_area_by_radius), max(data$not_accessible_area_by_radius) + 0.0001)) +
scale_y_continuous(limits = c(0, max(data$students_per_school_mean))) +
theme(legend.position="none") +
geom_smooth(method=lm) +
geom_text(aes(x = 2000, y = 1050, label = lm_eqn(data, data$not_accessible_area_by_radius, data$students_per_school_mean)), parse = TRUE, family="serif", fontface="italic", size=16) +
#geom_text(aes(x = data$not_accessible_area_by_radius, y = data$students_per_school_mean, label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +
xlab("Число школьников, проживающих дальше 500 м \n от ближайшей школы") +
ylab("Среднее число обучающихся на одну школу");
scat_not_accessible_students_by_radius_ON_students_per_school_mean
save.image()
savehistory()
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean
scat_not_accessible_students_by_radius_ON_students_per_school_mean
scat_not_accessible_students_by_google_ON_students_per_school_mean
lm_eqn = function(df, x, y){
m = lm(y ~ x, df);
eq <- substitute(italic(Ŷ) == a + b %.% italic(X)*","~~italic(R)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
scat_not_accessible_students_by_google_ON_students_per_school_mean
savehistory
savehistory()
save.image()
?lapply
ls()
dir
dir()
getwd()
attributes(data)
attributes(data_colnames)
attributes(freqhist_not_accessible_students_by_google)
install.packages("swirl")
library("swirl")
lm
?lm
search()
install.packages("ggplot2")
.libPaths()
