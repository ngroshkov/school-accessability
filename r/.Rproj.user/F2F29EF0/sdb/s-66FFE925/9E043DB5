{
    "contents" : "data_not_accessible_students_by_radius_percent_eqn = function(df){\n  m = lm(df[[2]] ~ df[[3]], df);\n  eq <- substitute(italic(y) == a + b %.% italic(x)*\",\"~~italic(r)^2~\"=\"~r2,\n                   list(a = format(coef(m)[1], digits = 2),\n                        b = format(coef(m)[2], digits = 2),\n                        r2 = format(summary(m)$r.squared, digits = 3)))\n  as.character(as.expression(eq));\n}\n\ndata_not_accessible_students_by_google_percent_eqn = function(df){\n  m = lm(df[[2]] ~ df[[4]], df);\n  eq <- substitute(italic(y) == a + b %.% italic(x)*\",\"~~italic(r)^2~\"=\"~r2,\n                   list(a = format(coef(m)[1], digits = 2),\n                        b = format(coef(m)[2], digits = 2),\n                        r2 = format(summary(m)$r.squared, digits = 3)))\n  as.character(as.expression(eq));\n}\n\ndata_not_accessible_students_by_radius_percent <- ggplot(data, aes(x=data[[5]], y=data[[2]])) +\n  geom_point(aes(color=cut(data[[2]], breaks=seq(99, 999, by = 100)), size=4)) +\n  #geom_text(aes(label=rownames(data)), colour=\"black\", size=3, hjust=-0.1, vjust=0) +\n  scale_colour_manual(\"\", \n                    values=c(\"#730000\", \"#A80000\", \"#e60000\", \"#ff7f7f\", \"#a3ff73\", \"#55ff00\", \"#4ce600\", \"#38a800\", \"#267300\", \"#264500\")) +\n  \n  #scale_colour_manual(values = c(\"red\",\"green\")) +\n  scale_x_continuous(limits = c(min(data[[5]]), max(data[[5]]) + 0.0001)) +\n  theme(legend.position=\"none\") +\n  #geom_smooth(method=lm, se=FALSE) +\n  #geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_radius_percent_eqn(data)), parse = TRUE) +\n  xlab(gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[5]])) +\n  ylab(gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[2]]));\n\ndata_not_accessible_students_by_google_percent <- ggplot(data, aes(x=data[[6]], y=data[[2]])) +\n  geom_point(aes(color=factor(sign(data[[2]]-500)), size=4)) +\n  #geom_text(aes(label=rownames(data)), colour=\"black\", size=3, hjust=-0.1, vjust=0) +\n  scale_colour_manual(values = c(\"red\",\"green\")) +\n  scale_x_continuous(limits = c(min(data[[6]]), max(data[[6]]) + 0.0001)) +\n  theme(legend.position=\"none\") +\n  #geom_smooth(method=lm, se=FALSE) +\n  #geom_text(aes(x = data[[3]], y = data[[2]], label = not_accessible_students_by_google_percent_eqn(data)), parse = TRUE) +\n  xlab(gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[6]])) +\n  ylab(gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[2]]));\n\ndata_students_per_school_mean_hist <- ggplot(data, aes(x=data[[2]])) +\n  geom_histogram(aes(fill=cut(data[[2]], breaks=seq(99, 999, by = 100))), binwidth = 25) +\n  #geom_density(alpha=.2) +\n  scale_x_continuous(name=gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[2]]), breaks=seq(0, 1000, by = 100), limits=c(0, 1000)) +\n  scale_y_continuous(name=gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', \"Частота распределения\"), breaks=0:20) +\n  scale_fill_manual(\"\", breaks=levels(cut(data[[2]], breaks=seq(99, 999, by = 100), right = FALSE)), \n                    values=c(\"#730000\", \"#A80000\", \"#e60000\", \"#ff7f7f\", \"#a3ff73\", \"#55ff00\", \"#4ce600\", \"#38a800\", \"#267300\", \"#264500\")) +\n  theme(legend.position=\"none\")\n\n\ndata_not_accessible_students_by_radius_hist <- ggplot(data, aes(x=data[[5]])) +\n  geom_histogram(aes(y=..count..), colour=\"black\", fill=\"white\", binwidth = 50) +\n  #geom_density(alpha=.2) +\n  scale_x_continuous(name=gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[5]]), breaks=seq(0, 3400, by = 200)) +\n  scale_y_continuous(name=gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', \"Частота распределения\"), breaks=0:15)\n\ndata_not_accessible_students_by_google_hist <- ggplot(data, aes(x=data[[6]])) +\n  geom_histogram(aes(y=..count..), colour=\"black\", fill=\"white\", binwidth = 250) +\n  #geom_density(alpha=.2) +\n  scale_x_continuous(name=gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', data_colnames[[6]]),  breaks=seq(0, 10000, by = 500)) +\n  scale_y_continuous(name=gsub('(.{1,46})(\\\\s|$)', '\\\\1\\n', \"Частота распределения\"), breaks=0:15)",
    "created" : 1414432410457.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3772201811",
    "id" : "9E043DB5",
    "lastKnownWriteTime" : 1417014038,
    "path" : "/media/WORK/Dropbox/ВШУ/hse/r/data.R",
    "project_path" : "data.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}